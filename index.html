<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Expense Tracker</title>

<style>
*{box-sizing:border-box}

/* ===== FONTS ===== */
body{
  margin:0;
  font-family:Candara, Calibri, Segoe, sans-serif;
  background:#f6f7fb;
  color:#1f2937;
  padding:30px;
}

.money{
  font-family:Cambria, "Cambria Math", serif;
  font-weight:700;
}

.container{max-width:1200px;margin:auto}

/* ===== OUTLINE SYSTEM ===== */
.outline-blue{border-left:5px solid #2563eb}
.outline-red{border-left:5px solid #dc2626}
.outline-green{border-left:5px solid #16a34a}
.outline-teal{border-left:5px solid #0f766e}

/* ===== DASHBOARD ===== */
.dashboard{
  display:grid;
  grid-template-columns:repeat(4,1fr);
  gap:16px;
  margin-bottom:25px;
}

.card{
  padding:22px;
  border-radius:14px;
  color:white;
  box-shadow:0 6px 18px rgba(0,0,0,.15);
}

.balance{background:#2563eb}
.spend{background:#dc2626}
.remain{background:#16a34a}
.today{background:#0f766e}

.card small{opacity:.95}
.card span{font-size:24px}

/* ===== SETTINGS ===== */
.settings{
  display:grid;
  grid-template-columns:repeat(2,1fr);
  gap:16px;
  margin-bottom:25px;
}

.settings div{
  background:white;
  padding:16px;
  border-radius:12px;
  box-shadow:0 4px 14px rgba(0,0,0,.08);
}

/* ===== FORM ===== */
.form-card{
  background:white;
  border-radius:16px;
  padding:24px;
  margin-bottom:30px;
  box-shadow:0 8px 22px rgba(0,0,0,.10);
}

form{
  display:grid;
  grid-template-columns:repeat(3,1fr);
  gap:16px;
}

label{font-size:13px}

input,select{
  padding:10px;
  border-radius:8px;
  border:1px solid #d1d5db;
}

/* TYPE */
.toggle{display:flex;gap:8px}
.toggle button{
  flex:1;
  padding:10px;
  border-radius:999px;
  border:2px solid #d1d5db;
  background:white;
  cursor:pointer;
  font-weight:700;
}
.toggle .in.active{border-color:#16a34a;color:#16a34a}
.toggle .out.active{border-color:#dc2626;color:#dc2626}

/* PROOF */
.preview img{
  width:70px;
  margin-top:8px;
  border-radius:10px;
}

/* PROGRESS */
.progress{
  height:8px;
  background:#e5e7eb;
  border-radius:999px;
  overflow:hidden;
}
.progress div{height:100%;background:#2563eb}

/* TABLE */
.table-box{
  background:white;
  border-radius:16px;
  overflow:hidden;
  box-shadow:0 8px 22px rgba(0,0,0,.10);
}

table{width:100%}
thead{background:#2563eb}
th{color:white;padding:12px;font-size:13px;text-align:left}
td{padding:14px;font-size:14px}

.in{color:#16a34a;font-weight:700}
.out{color:#dc2626;font-weight:700}

img.proof{width:42px;border-radius:8px;cursor:pointer}

/* ===== BOTTOM NAV ===== */
.bottom-nav{
  position:fixed;
  bottom:20px;
  left:0;
  width:100%;
  display:flex;
  justify-content:space-between;
  padding:0 30px;
  pointer-events:none;
}

.bottom-nav a{
  pointer-events:auto;
  text-decoration:none;
  background:#2563eb;
  color:white;
  padding:10px 18px;
  border-radius:999px;
  font-weight:700;
  box-shadow:0 6px 18px rgba(0,0,0,.25);
}

/* MOBILE */
@media(max-width:768px){
  body{padding:15px}
  .dashboard{grid-template-columns:repeat(2,1fr)}
  .settings{grid-template-columns:1fr}
  form{grid-template-columns:1fr}
  .bottom-nav{padding:0 15px}
}
</style>
</head>

<body>

<div class="container">

<!-- DASHBOARD -->
<div class="dashboard">
  <div class="card balance outline-blue">
    <small>Total Balance</small><br>
    â‚¹ <span id="bal" class="money">0</span>
  </div>

  <div class="card spend outline-red">
    <small>Total Spend</small><br>
    â‚¹ <span id="sp" class="money">0</span>
  </div>

  <div class="card remain outline-green">
    <small>Total Remain</small><br>
    â‚¹ <span id="rm" class="money">0</span>
  </div>

  <div class="card today outline-teal">
    <small>Today</small><br>
    â‚¹ <span id="todaySpend" class="money">0</span> /
    â‚¹ <span id="todayLimit" class="money">â€”</span>
  </div>
</div>

<!-- SETTINGS -->
<div class="settings">
  <div class="outline-blue">
    <label>Daily Limit (Optional)</label>
    <input type="number" id="dailyLimit">
  </div>
  <div class="outline-blue">
    <label>Monthly Budget (Optional)</label>
    <input type="number" id="monthlyBudget">
  </div>
</div>

<!-- MONTHLY -->
<div class="form-card outline-blue">
  <label>Monthly Budget Progress</label>
  <div class="progress"><div id="monthProgress"></div></div>
  <small id="monthText"></small>
</div>

<!-- FORM -->
<div class="form-card outline-blue">
<form id="form">
  <div><label>Date</label><input type="date" id="date" required></div>

  <div>
    <label>Type</label>
    <div class="toggle">
      <button type="button" class="in" onclick="setType('IN')">IN</button>
      <button type="button" class="out" onclick="setType('OUT')">OUT</button>
    </div>
  </div>

  <div>
    <label>Category</label>
    <select id="category">
      <option>Food</option>
      <option>Travel</option>
      <option>Rent</option>
      <option>Bills</option>
      <option>Others</option>
    </select>
  </div>

  <div><label>Amount</label><input type="number" id="amount" required></div>

  <div>
    <label>Proof</label>
    <input type="file" id="proof" accept="image/*" onchange="previewImage()">
    <div class="preview" id="preview"></div>
  </div>

  <div style="grid-column:span 3">
    <label>Note</label><input type="text" id="note">
  </div>

  <button style="grid-column:span 3;padding:12px;border:none;border-radius:999px;background:#2563eb;color:white;font-weight:700">
    Save Transaction
  </button>
</form>
</div>

<!-- TABLE -->
<div class="table-box outline-blue">
<table>
<thead>
<tr>
  <th>Date</th><th>Type</th><th>Category</th>
  <th>Amount</th><th>Proof</th><th>Note</th>
</tr>
</thead>
<tbody id="table"></tbody>
</table>
</div>

</div>

<!-- BOTTOM BUTTONS -->
<div class="bottom-nav">
  <a href="history.html">ðŸ“œ View History</a>
  <a href="analytics.html">ðŸ“Š View Analytics</a>
</div>

<script>
/* ðŸ”´ PASTE GOOGLE WEB APP URL HERE */
const API_URL = "https://script.google.com/macros/s/AKfycbyucNg-_rXfdnIsHQf_XnitffZtS4KdLNkqyrMGUCUKWM1fWGimkrTpA-KBWicRHfsVwA/exec";

let transactions=[];
let currentType="";

date.valueAsDate=new Date();

function setType(t){
  currentType=t;
  document.querySelectorAll(".toggle button").forEach(b=>b.classList.remove("active"));
  document.querySelector("."+t.toLowerCase()).classList.add("active");
}

function previewImage(){
  const f=proof.files[0];
  if(!f)return;
  const r=new FileReader();
  r.onload=()=>preview.innerHTML=`<img src="${r.result}">`;
  r.readAsDataURL(f);
}

async function fetchTransactions(){
  const res=await fetch(API_URL);
  transactions=await res.json();
  render();
}

form.onsubmit=async e=>{
  e.preventDefault();
  if(!currentType || amount.value<=0) return alert("Invalid input");

  const reader=new FileReader();
  reader.onload=async()=>{
    await fetch(API_URL,{
      method:"POST",
      body:JSON.stringify({
        date:date.value,
        type:currentType,
        category:category.value,
        amount:+amount.value,
        note:note.value,
        proof:reader.result||""
      })
    });
    form.reset();preview.innerHTML="";date.valueAsDate=new Date();
    fetchTransactions();
  };
  proof.files[0]?reader.readAsDataURL(proof.files[0]):reader.onload();
};

function render(){
  let b=0,s=0,today=0,monthSpend=0;
  const todayStr=new Date().toISOString().slice(0,10);
  const currentMonth=todayStr.slice(0,7);

  table.innerHTML="";
  transactions.forEach(t=>{
    t.type==="IN"?b+=+t.amount:s+=+t.amount;
    if(t.type==="OUT" && t.date===todayStr) today+=+t.amount;
    if(t.type==="OUT" && t.date.startsWith(currentMonth)) monthSpend+=+t.amount;
  });

  bal.textContent=b;
  sp.textContent=s;
  rm.textContent=Math.max(b-s,0);
  todaySpend.textContent=today;
  todayLimit.textContent=dailyLimit.value||"â€”";

  const mb=+monthlyBudget.value;
  if(mb){
    const pct=Math.min(monthSpend/mb*100,100);
    monthProgress.style.width=pct+"%";
    monthText.textContent=`Used â‚¹${monthSpend} of â‚¹${mb} (${pct.toFixed(1)}%)`;
  }else{
    monthProgress.style.width="0%";
    monthText.textContent="No monthly budget set";
  }

  transactions.slice(0,5).forEach(t=>{
    table.innerHTML+=`
      <tr>
        <td>${t.date}</td>
        <td class="${t.type==="IN"?"in":"out"}">${t.type}</td>
        <td>${t.category}</td>
        <td class="money">â‚¹${t.amount}</td>
        <td>${t.proof?`<img class="proof" src="${t.proof}" onclick="open('${t.proof}')">`:"-"}</td>
        <td>${t.note}</td>
      </tr>`;
  });
}

fetchTransactions();
</script>

</body>
</html>

